/*!
 * lx-valid - v0.2.3 - 2013-06-03
 * https://github.com/litixsoft/lx-valid
 *
 * Copyright (c) 2013 Litixsoft GmbH
 * Licensed MIT
 */

(function(e){function n(e,u,i){i=t({},n.defaults,i);var a=[];return r(e,u,i,a),{valid:!a.length,errors:a}}function t(e){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var t=n.shift();if(t){if("object"!=typeof t)throw new TypeError("mixin non-object");for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}}return e}function r(e,n,t,r){var i,o=Object.keys(e),l=[];if(n.properties){i=n.properties;for(var c in i)i.hasOwnProperty(c)&&(l.push(c),u(e,e[c],c,i[c],t,r))}if(n.patternProperties){i=n.patternProperties;for(var c in i)if(i.hasOwnProperty(c)){var f=RegExp(c);for(var s in e)e.hasOwnProperty(s)&&(l.push(s),null!==f.exec(s)&&u(e,e[s],c,i[c],t,r))}}if(t.deleteUnknownProperties){i=n.properties?Object.keys(n.properties):[],i=i.concat(n.patternProperties?Object.keys(n.patternProperties):[]);for(var c in e)-1===i.indexOf(c)&&delete e[c]}if(void 0!==n.additionalProperties){var m,d,p=o.filter(function(e){return-1===l.indexOf(e)});if(n.additionalProperties===!1&&p.length>0)for(m=0,d=p.length;d>m;m++)a("additionalProperties",p[m],e[p[m]],!1,r);else if("object"==typeof n.additionalProperties&&p.length>0)for(m=0,d=p.length;d>m;m++)u(e,e[p[m]],p[m],n.unvisitedProperties,t,r)}}function u(e,t,l,c,f,s){function m(e,n,t){void 0===c[e]||t(n,c[e])||a(e,l,n,c,s)}var d,p;if(void 0===t){if(void 0===c.default||!f.addMissingDefaults)return c.required&&"any"!==c.type?a("required",l,void 0,c,s):void 0;e[l]=t="function"==typeof c.default?c.default():c.default}if(f.cast&&("integer"!==c.type&&"number"!==c.type||t!=+t||(t=+t),"boolean"===c.type&&(("true"===t||"1"===t||1===t)&&(t=!0),("false"===t||"0"===t||0===t)&&(t=!1))),c.format&&f.validateFormats)if(d=c.format,f.validateFormatExtensions&&(p=n.formatExtensions[d]),p||(p=n.formats[d]),p){if(!p.test(t))return a("format",l,t,c,s);if(f.convert&&"function"==typeof f.convert)if(Array.isArray(e[l])){var F=e[l].indexOf(t);e[l][F]=f.convert(c.format,t)}else e[l]=f.convert(c.format,t)}else if(f.validateFormatsStrict)return a("format",l,t,c,s);if(c["enum"]&&-1===c["enum"].indexOf(t)&&a("enum",l,t,c,s),"string"==typeof c.dependencies&&void 0===e[c.dependencies]&&a("dependencies",l,null,c,s),o(c.dependencies))for(var y=0,v=c.dependencies.length;v>y;y++)void 0===e[c.dependencies[y]]&&a("dependencies",l,null,c,s);"object"==typeof c.dependencies&&r(e,c.dependencies,f,s),i(t,c.type,function(n,i){if(n)return a("type",l,typeof t,c,s);switch(m("conform",t,function(e,n){return n(e)}),i||(o(t)?"array":typeof t)){case"string":m("minLength",t.length,function(e,n){return e>=n}),m("maxLength",t.length,function(e,n){return n>=e}),m("pattern",t,function(e,n){return n="string"==typeof n?n=RegExp(n):n,n.test(e)});break;case"integer":case"number":m("minimum",t,function(e,n){return e>=n}),m("maximum",t,function(e,n){return n>=e}),m("exclusiveMinimum",t,function(e,n){return e>n}),m("exclusiveMaximum",t,function(e,n){return n>e}),m("divisibleBy",t,function(e,n){var t=Math.max((""+(e-Math.floor(e))).length-2,(""+(n-Math.floor(n))).length-2);return t=t>0?Math.pow(10,t):1,0===e*t%(n*t)});break;case"array":m("items",t,function(n,t){for(var r=0,i=n.length;i>r;r++)u(e,n[r],l,t,f,s);return!0}),m("minItems",t,function(e,n){return e.length>=n}),m("maxItems",t,function(e,n){return n>=e.length}),m("uniqueItems",t,function(e){for(var n={},t=0,r=e.length;r>t;t++){var u=JSON.stringify(e[t]);if(n[u])return!1;n[u]=!0}return!0});break;case"object":(c.properties||c.patternProperties||c.additionalProperties)&&r(t,c,f,s)}})}function i(e,n,t){var r=o(n)?n:[n];if(void 0===n)return t(null,n);for(var u=0,i=r.length;i>u;u++)if(n=r[u].toLowerCase().trim(),"string"===n?"string"==typeof e:"array"===n?o(e):"object"===n?e&&"object"==typeof e&&!o(e):"number"===n?"number"==typeof e:"integer"===n?"number"==typeof e&&~~e===e:"null"===n?null===e:"boolean"===n?"boolean"==typeof e:"any"===n?e!==void 0:!1)return t(null,n);t(!0)}function a(e,t,r,u,i){var a={expected:u[e],attribute:e,property:t},o=u.messages&&u.messages[e]||u.message||n.messages[e]||"no default message";o=o.replace(/%\{([a-z]+)\}/gi,function(e,n){return a[n.toLowerCase()]||""}),i.push({attribute:e,property:t,expected:u[e],actual:r,message:o})}function o(e){var n=typeof e;return"object"===n&&e&&"number"==typeof e.length&&!e.propertyIsEnumerable("length")&&"function"==typeof e.splice?!0:!1}e.validate=n,e.mixin=t,n.defaults={validateFormats:!0,validateFormatsStrict:!1,validateFormatExtensions:!0,addMissingDefaults:!1,deleteUnknownProperties:!1},n.messages={required:"is required",minLength:"is too short (minimum is %{expected} characters)",maxLength:"is too long (maximum is %{expected} characters)",pattern:"invalid input",minimum:"must be greater than or equal to %{expected}",maximum:"must be less than or equal to %{expected}",exclusiveMinimum:"must be greater than %{expected}",exclusiveMaximum:"must be less than %{expected}",divisibleBy:"must be divisible by %{expected}",minItems:"must contain more than %{expected} items",maxItems:"must contain less than %{expected} items",uniqueItems:"must hold a unique set of values",format:"is not a valid %{expected}",conform:"must conform to given constraint",type:"must be of %{expected} type"},n.messages["enum"]="must be present in given enumerator",n.formats={email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,"ip-address":/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/i,ipv6:/^([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}$/,"date-time":/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:.\d{1,3})?Z$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^\d{2}:\d{2}:\d{2}$/,color:/^#[a-z0-9]{6}|#[a-z0-9]{3}|(?:rgb\(\s*(?:[+-]?\d+%?)\s*,\s*(?:[+-]?\d+%?)\s*,\s*(?:[+-]?\d+%?)\s*\))aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|and yellow$/i,"host-name":/^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])/,"utc-millisec":{test:function(e){return"number"==typeof e&&e>=0}},regex:{test:function(e){try{RegExp(e)}catch(n){return!1}return!0}}},n.formatExtensions={url:/^(https?|ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i}})("undefined"==typeof window?module.exports:window.json=window.json||{}),function(){function e(e){var t=!1;return function(){if(t)throw Error("Callback was already called.");t=!0,e.apply(n,arguments)}}var n,t,r={};n=this,null!=n&&(t=n.async),r.noConflict=function(){return n.async=t,r};var u=function(e,n){if(e.forEach)return e.forEach(n);for(var t=0;e.length>t;t+=1)n(e[t],t,e)},i=function(e,n){if(e.map)return e.map(n);var t=[];return u(e,function(e,r,u){t.push(n(e,r,u))}),t},a=function(e,n,t){return e.reduce?e.reduce(n,t):(u(e,function(e,r,u){t=n(t,e,r,u)}),t)},o=function(e){if(Object.keys)return Object.keys(e);var n=[];for(var t in e)e.hasOwnProperty(t)&&n.push(t);return n};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,r.setImmediate="undefined"!=typeof setImmediate?setImmediate:r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(e){setImmediate(e)},r.setImmediate=r.nextTick):(r.nextTick=function(e){setTimeout(e,0)},r.setImmediate=r.nextTick),r.each=function(n,t,r){if(r=r||function(){},!n.length)return r();var i=0;u(n,function(u){t(u,e(function(e){e?(r(e),r=function(){}):(i+=1,i>=n.length&&r(null))}))})},r.forEach=r.each,r.eachSeries=function(e,n,t){if(t=t||function(){},!e.length)return t();var r=0,u=function(){n(e[r],function(n){n?(t(n),t=function(){}):(r+=1,r>=e.length?t(null):u())})};u()},r.forEachSeries=r.eachSeries,r.eachLimit=function(e,n,t,r){var u=l(n);u.apply(null,[e,t,r])},r.forEachLimit=r.eachLimit;var l=function(e){return function(n,t,r){if(r=r||function(){},!n.length||0>=e)return r();var u=0,i=0,a=0;(function o(){if(u>=n.length)return r();for(;e>a&&n.length>i;)i+=1,a+=1,t(n[i-1],function(e){e?(r(e),r=function(){}):(u+=1,a-=1,u>=n.length?r():o())})})()}},c=function(e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[r.each].concat(n))}},f=function(e,n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[l(e)].concat(t))}},s=function(e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[r.eachSeries].concat(n))}},m=function(e,n,t,r){var u=[];n=i(n,function(e,n){return{index:n,value:e}}),e(n,function(e,n){t(e.value,function(t,r){u[e.index]=r,n(t)})},function(e){r(e,u)})};r.map=c(m),r.mapSeries=s(m),r.mapLimit=function(e,n,t,r){return d(n)(e,t,r)};var d=function(e){return f(e,m)};r.reduce=function(e,n,t,u){r.eachSeries(e,function(e,r){t(n,e,function(e,t){n=t,r(e)})},function(e){u(e,n)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(e,n,t,u){var a=i(e,function(e){return e}).reverse();r.reduce(a,n,t,u)},r.foldr=r.reduceRight;var p=function(e,n,t,r){var u=[];n=i(n,function(e,n){return{index:n,value:e}}),e(n,function(e,n){t(e.value,function(t){t&&u.push(e),n()})},function(){r(i(u.sort(function(e,n){return e.index-n.index}),function(e){return e.value}))})};r.filter=c(p),r.filterSeries=s(p),r.select=r.filter,r.selectSeries=r.filterSeries;var F=function(e,n,t,r){var u=[];n=i(n,function(e,n){return{index:n,value:e}}),e(n,function(e,n){t(e.value,function(t){t||u.push(e),n()})},function(){r(i(u.sort(function(e,n){return e.index-n.index}),function(e){return e.value}))})};r.reject=c(F),r.rejectSeries=s(F);var y=function(e,n,t,r){e(n,function(e,n){t(e,function(t){t?(r(e),r=function(){}):n()})},function(){r()})};r.detect=c(y),r.detectSeries=s(y),r.some=function(e,n,t){r.each(e,function(e,r){n(e,function(e){e&&(t(!0),t=function(){}),r()})},function(){t(!1)})},r.any=r.some,r.every=function(e,n,t){r.each(e,function(e,r){n(e,function(e){e||(t(!1),t=function(){}),r()})},function(){t(!0)})},r.all=r.every,r.sortBy=function(e,n,t){r.map(e,function(e,t){n(e,function(n,r){n?t(n):t(null,{value:e,criteria:r})})},function(e,n){if(e)return t(e);var r=function(e,n){var t=e.criteria,r=n.criteria;return r>t?-1:t>r?1:0};t(null,i(n.sort(r),function(e){return e.value}))})},r.auto=function(e,n){n=n||function(){};var t=o(e);if(!t.length)return n(null);var i={},l=[],c=function(e){l.unshift(e)},f=function(e){for(var n=0;l.length>n;n+=1)if(l[n]===e)return l.splice(n,1),void 0},s=function(){u(l.slice(0),function(e){e()})};c(function(){o(i).length===t.length&&(n(null,i),n=function(){})}),u(t,function(t){var l=e[t]instanceof Function?[e[t]]:e[t],m=function(e){var a=Array.prototype.slice.call(arguments,1);if(1>=a.length&&(a=a[0]),e){var l={};u(o(i),function(e){l[e]=i[e]}),l[t]=a,n(e,l),n=function(){}}else i[t]=a,r.setImmediate(s)},d=l.slice(0,Math.abs(l.length-1))||[],p=function(){return a(d,function(e,n){return e&&i.hasOwnProperty(n)},!0)&&!i.hasOwnProperty(t)};if(p())l[l.length-1](m,i);else{var F=function(){p()&&(f(F),l[l.length-1](m,i))};c(F)}})},r.waterfall=function(e,n){if(n=n||function(){},e.constructor!==Array){var t=Error("First argument to waterfall must be an array of functions");return n(t)}if(!e.length)return n();var u=function(e){return function(t){if(t)n.apply(null,arguments),n=function(){};else{var i=Array.prototype.slice.call(arguments,1),a=e.next();a?i.push(u(a)):i.push(n),r.setImmediate(function(){e.apply(null,i)})}}};u(r.iterator(e))()};var v=function(e,n,t){if(t=t||function(){},n.constructor===Array)e.map(n,function(e,n){e&&e(function(e){var t=Array.prototype.slice.call(arguments,1);1>=t.length&&(t=t[0]),n.call(null,e,t)})},t);else{var r={};e.each(o(n),function(e,t){n[e](function(n){var u=Array.prototype.slice.call(arguments,1);1>=u.length&&(u=u[0]),r[e]=u,t(n)})},function(e){t(e,r)})}};r.parallel=function(e,n){v({map:r.map,each:r.each},e,n)},r.parallelLimit=function(e,n,t){v({map:d(n),each:l(n)},e,t)},r.series=function(e,n){if(n=n||function(){},e.constructor===Array)r.mapSeries(e,function(e,n){e&&e(function(e){var t=Array.prototype.slice.call(arguments,1);1>=t.length&&(t=t[0]),n.call(null,e,t)})},n);else{var t={};r.eachSeries(o(e),function(n,r){e[n](function(e){var u=Array.prototype.slice.call(arguments,1);1>=u.length&&(u=u[0]),t[n]=u,r(e)})},function(e){n(e,t)})}},r.iterator=function(e){var n=function(t){var r=function(){return e.length&&e[t].apply(null,arguments),r.next()};return r.next=function(){return e.length-1>t?n(t+1):null},r};return n(0)},r.apply=function(e){var n=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,n.concat(Array.prototype.slice.call(arguments)))}};var g=function(e,n,t,r){var u=[];e(n,function(e,n){t(e,function(e,t){u=u.concat(t||[]),n(e)})},function(e){r(e,u)})};r.concat=c(g),r.concatSeries=s(g),r.whilst=function(e,n,t){e()?n(function(u){return u?t(u):(r.whilst(e,n,t),void 0)}):t()},r.doWhilst=function(e,n,t){e(function(u){return u?t(u):(n()?r.doWhilst(e,n,t):t(),void 0)})},r.until=function(e,n,t){e()?t():n(function(u){return u?t(u):(r.until(e,n,t),void 0)})},r.doUntil=function(e,n,t){e(function(u){return u?t(u):(n()?t():r.doUntil(e,n,t),void 0)})},r.queue=function(n,t){function i(e,n,i,a){n.constructor!==Array&&(n=[n]),u(n,function(n){var u={data:n,callback:"function"==typeof a?a:null};i?e.tasks.unshift(u):e.tasks.push(u),e.saturated&&e.tasks.length===t&&e.saturated(),r.setImmediate(e.process)})}void 0===t&&(t=1);var a=0,o={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,push:function(e,n){i(o,e,!1,n)},unshift:function(e,n){i(o,e,!0,n)},process:function(){if(o.concurrency>a&&o.tasks.length){var t=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),a+=1;var r=function(){a-=1,t.callback&&t.callback.apply(t,arguments),o.drain&&0===o.tasks.length+a&&o.drain(),o.process()},u=e(r);n(t.data,u)}},length:function(){return o.tasks.length},running:function(){return a}};return o},r.cargo=function(e,n){var t=!1,a=[],o={tasks:a,payload:n,saturated:null,empty:null,drain:null,push:function(e,t){e.constructor!==Array&&(e=[e]),u(e,function(e){a.push({data:e,callback:"function"==typeof t?t:null}),o.saturated&&a.length===n&&o.saturated()}),r.setImmediate(o.process)},process:function l(){if(!t){if(0===a.length)return o.drain&&o.drain(),void 0;var r="number"==typeof n?a.splice(0,n):a.splice(0),c=i(r,function(e){return e.data});o.empty&&o.empty(),t=!0,e(c,function(){t=!1;var e=arguments;u(r,function(n){n.callback&&n.callback.apply(null,e)}),l()})}},length:function(){return a.length},running:function(){return t}};return o};var h=function(e){return function(n){var t=Array.prototype.slice.call(arguments,1);n.apply(null,t.concat([function(n){var t=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(n?console.error&&console.error(n):console[e]&&u(t,function(n){console[e](n)}))}]))}};r.log=h("log"),r.dir=h("dir"),r.memoize=function(e,n){var t={},r={};n=n||function(e){return e};var u=function(){var u=Array.prototype.slice.call(arguments),i=u.pop(),a=n.apply(null,u);a in t?i.apply(null,t[a]):a in r?r[a].push(i):(r[a]=[i],e.apply(null,u.concat([function(){t[a]=arguments;var e=r[a];delete r[a];for(var n=0,u=e.length;u>n;n++)e[n].apply(null,arguments)}])))};return u.memo=t,u.unmemoized=e,u},r.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},r.times=function(e,n,t){for(var u=[],i=0;e>i;i++)u.push(i);return r.map(u,n,t)},r.timesSeries=function(e,n,t){for(var u=[],i=0;e>i;i++)u.push(i);return r.mapSeries(u,n,t)},r.compose=function(){var e=Array.prototype.reverse.call(arguments);return function(){var n=this,t=Array.prototype.slice.call(arguments),u=t.pop();r.reduce(e,t,function(e,t,r){t.apply(n,e.concat([function(){var e=arguments[0],n=Array.prototype.slice.call(arguments,1);r(e,n)}]))},function(e,t){u.apply(n,[e].concat(t))})}};var x=function(e,n){var t=function(){var t=this,r=Array.prototype.slice.call(arguments),u=r.pop();return e(n,function(e,n){e.apply(t,r.concat([n]))},u)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return t.apply(this,r)}return t};r.applyEach=c(x),r.applyEachSeries=s(x),r.forever=function(e,n){function t(r){if(r){if(n)return n(r);throw r}e(t)}t()},"undefined"!=typeof define&&define.amd?define([],function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:n.async=r}(),function(e,n,t){"use strict";function r(e,t){if("string"!=typeof e||!(t instanceof RegExp))throw Error("extensionName or extensionValue undefined or not correct type");if(n.validate.formats.hasOwnProperty(e)||n.validate.formats.hasOwnProperty(e)){var r="extensionName: "+e+" already exists in formatExtensions.";throw Error(r)}n.validate.formatExtensions[e]=t}function u(e,t){return n.validate.messages[e].replace("%{expected}",t)+""}function i(e,n,t){var r={attribute:"",expected:"",actual:"",message:""};return r.attribute=e,r.expected=n,r.actual=t,r.message=u(e,n),r}function a(e){var n={valid:!0,errors:[]};return null!==e&&(n.valid=!1,n.errors.push(e)),n}function o(e){for(var n={},t=0,r=e.length;r>t;t++){var u=JSON.stringify(e[t]);if(n[u])return!1;n[u]=!0}return!0}function l(){var e={};return e.email=function(e){return n.validate.formats.email.test(e)?a(null):a(i("format","email",e))},e.ipAddress=function(e){return n.validate.formats["ip-address"].test(e)?a(null):a(i("format","ip-address",e))},e.ipv6=function(e){return n.validate.formats.ipv6.test(e)?a(null):a(i("format","ipv6",e))},e.dateTime=function(e){return n.validate.formats["date-time"].test(e)?a(null):a(i("format","date-time",e))},e.date=function(e){return n.validate.formats.date.test(e)?a(null):a(i("format","date",e))},e.time=function(e){return n.validate.formats.time.test(e)?a(null):a(i("format","time",e))},e.color=function(e){return n.validate.formats.color.test(e)?a(null):a(i("format","color",e))},e.hostName=function(e){return n.validate.formats["host-name"].test(e)?a(null):a(i("format","host-name",e))},e.utcMillisec=function(e){return n.validate.formats["utc-millisec"].test(e)?a(null):a(i("format","utc-millisec",e))},e.regex=function(e){return e instanceof RegExp?a(null):a(i("format","regex",e))},e.url=function(e){return n.validate.formatExtensions.url.test(e)?a(null):a(i("format","url",e))},e.mongoId=function(e){return n.validate.formatExtensions["mongo-id"].test(e)?a(null):a(i("format","mongoId",e))},e.numberFloat=function(e){return n.validate.formatExtensions["number-float"].test(e)?a(null):a(i("format","float",e))},e}function c(){var e={};return e.string=function(e){return"string"!=typeof e?a(i("type","string",e)):a(null)},e.number=function(e){return"number"!=typeof e?a(i("type","number",e)):a(null)},e.boolean=function(e){return"boolean"!=typeof e?a(i("type","boolean",e)):a(null)},e.object=function(e){return"object"!=typeof e?a(i("type","object",e)):a(null)},e.undefined=function(e){return e!==void 0?a(i("type","undefined",e)):a(null)},e.integer=function(e){return"number"!=typeof e||~~e!==e?a(i("type","integer",e)):a(null)},e.float=function(e){return RegExp(/^[\-\+]?\b(\d+[.]\d+$)$/).exec(e)?a(null):a(i("type","float",e))},e.array=function(e){return Array.isArray(e)?a(null):a(i("type","array",e))},e.date=function(e){return e instanceof Date?a(null):a(i("type","Date",e))},e.regexp=function(e){return e instanceof RegExp?a(null):a(i("type","RegExp",e))},e.null=function(e){return null!==e?a(i("type","null",e)):a(null)},e.mongoId=function(e){return n.validate.formatExtensions["mongo-id"].test(""+e)?a(null):a(i("type","mongoId",e))},e}function f(){var e={};return e.maxLength=function(e,n){return!Array.isArray(e)&&"string"!=typeof e||"number"!=typeof n?a(Error("rules.maxLength(fail): value must be a string or array, max must be a number")):e.length>n?a(i("maxLength",n,e)):a(null)},e.minLength=function(e,n){return!Array.isArray(e)&&"string"!=typeof e||"number"!=typeof n?a(Error("rules.minLength(fail): value must be a string or array, min must be a number")):n>e.length?a(i("minLength",n,e)):a(null)},e.minimum=function(e,n){return"number"!=typeof e||"number"!=typeof n?a(Error("rules.minimum(fail): value must be a number, min must be a number")):n>e?a(i("minimum",n,e)):a(null)},e.maximum=function(e,n){return"number"!=typeof e||"number"!=typeof n?a(Error("rules.maximum(fail): value must be a number, max must be a number")):e>n?a(i("maximum",n,e)):a(null)},e.exclusiveMinimum=function(e,n){return"number"!=typeof e||"number"!=typeof n?a(Error("rules.exclusiveMinimum(fail): value must be a number, min must be a number")):n>=e?a(i("exclusiveMinimum",n,e)):a(null)},e.exclusiveMaximum=function(e,n){return"number"!=typeof e||"number"!=typeof n?a(Error("rules.exclusiveMaximum(fail): value must be a number, max must be a number")):e>=n?a(i("exclusiveMinimum",n,e)):a(null)},e.divisibleBy=function(e,n){if("number"!=typeof e||"number"!=typeof n)return a(Error("rules.divisibleBy(fail): value must be a number, div must be a number"));var t=Math.max((""+(e-Math.floor(e))).length-2,(""+(n-Math.floor(n))).length-2);return t=t>0?Math.pow(10,t):1,0!==e*t%(n*t)?a(i("divisibleBy",n,e)):a(null)},e.minItems=function(e,n){return Array.isArray(e)&&"number"==typeof n?n>e.length?a(i("minItems",n,e.length)):a(null):a(Error("rules.minItems(fail): value must be a array, min must be a number"))},e.maxItems=function(e,n){return Array.isArray(e)&&"number"==typeof n?e.length>n?a(i("maxItems",n,e.length)):a(null):a(Error("rules.maxItems(fail): value must be a array, max must be a number"))},e.uniqueItems=function(e){return Array.isArray(e)?o(e)?a(null):a(i("uniqueItems",e,!0)):a(Error("rules.uniqueItems(fail): value must be a array"))},e.enum=function(e,n){return void 0!==e&&Array.isArray(n)?-1===n.indexOf(e)?a(i("enum",n,e)):a(null):a(Error("rules.enum(fail): value must be a defined and enum mus be a array"))},e}function s(){var e={},n=[];return e.register=function(e,t){n.push(function(n){e(t,n)})},e.exec=function(e,r){t.parallel(n,function(t,u){if(n=[],t)r(t);else{var i,a;for(i=0,a=u.length;a>i;i+=1)u[i].valid||(e.valid=!1,e.errors.push(u[i].errors[0]));r(null,e)}})},e}function m(n){return function(t,r,u){if(t=t||{},u=u||{},u.isUpdate=u.isUpdate||!1,u.isUpdate){var i,a=Object.keys(r.properties),o=a.length;for(i=0;o>i;i++)t.hasOwnProperty(a[i])||(r.properties[a[i]].required=!1)}return e.validate(t,r,n)}}n.validate.formatExtensions["mongo-id"]=/^[0-9a-fA-F]{8}[0-9a-fA-F]{6}[0-9a-fA-F]{4}[0-9a-fA-F]{6}$/,n.validate.formatExtensions["number-float"]=/^[\-\+]?\b(\d+[.]\d+$)$/,e.validate=n.validate,e.mixin=n.mixin,e.extendFormat=r,e.formats=l(),e.types=c(),e.rules=f(),e.asyncValidate=s(),e.getValidationFunction=m}("undefined"==typeof window?module.exports:window.lxvalid=window.lxvalid||{},"undefined"==typeof window?require("revalidator"):window.json,"undefined"==typeof window?require("async"):window.async);