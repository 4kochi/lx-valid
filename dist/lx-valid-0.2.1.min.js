/*!
 * lx-valid - v0.2.1 - 2013-04-09
 * https://github.com/litixsoft/lx-valid
 *
 * Copyright (c) 2013 Litixsoft GmbH
 * Licensed MIT
 */

(function(n){function e(n,u,i){i=t({},e.defaults,i);var a=[];r(n,u,i,a);var o={valid:!a.length,errors:a};return i.convert&&"function"==typeof i.convert&&(o.convertedObject=n),o}function t(n){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var t=e.shift();if(t){if("object"!=typeof t)throw new TypeError("mixin non-object");for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}}return n}function r(n,e,t,r){var i,o=Object.keys(n),l=[];if(e.properties){i=e.properties;for(var c in i)i.hasOwnProperty(c)&&(l.push(c),u(n,n[c],c,i[c],t,r))}if(e.patternProperties){i=e.patternProperties;for(var c in i)if(i.hasOwnProperty(c)){var f=RegExp(c);for(var s in n)n.hasOwnProperty(s)&&(l.push(s),null!==f.exec(s)&&u(n,n[s],c,i[c],t,r))}}if(t.deleteUnknownProperties){i=e.properties?Object.keys(e.properties):[],i=i.concat(e.patternProperties?Object.keys(e.patternProperties):[]);for(var c in n)-1===i.indexOf(c)&&delete n[c]}if(void 0!==e.additionalProperties){var m,p,d=o.filter(function(n){return-1===l.indexOf(n)});if(e.additionalProperties===!1&&d.length>0)for(m=0,p=d.length;p>m;m++)a("additionalProperties",d[m],n[d[m]],!1,r);else if("object"==typeof e.additionalProperties&&d.length>0)for(m=0,p=d.length;p>m;m++)u(n,n[d[m]],d[m],e.unvisitedProperties,t,r)}}function u(n,t,l,c,f,s){function m(n,e,t){void 0===c[n]||t(e,c[n])||a(n,l,e,c,s)}var p,d;if(void 0===t){if(void 0===c.default||!f.addMissingDefaults)return c.required&&"any"!==c.type?a("required",l,void 0,c,s):void 0;n[l]=t="function"==typeof c.default?c.default():c.default}if(f.cast&&("integer"!==c.type&&"number"!==c.type||t!=+t||(t=+t),"boolean"===c.type&&(("true"===t||"1"===t||1===t)&&(t=!0),("false"===t||"0"===t||0===t)&&(t=!1))),c.format&&f.validateFormats)if(p=c.format,f.validateFormatExtensions&&(d=e.formatExtensions[p]),d||(d=e.formats[p]),d){if(!d.test(t))return a("format",l,t,c,s);f.convert&&"function"==typeof f.convert&&(n[l]=f.convert(c.format,t))}else if(f.validateFormatsStrict)return a("format",l,t,c,s);if(c["enum"]&&-1===c["enum"].indexOf(t)&&a("enum",l,t,c,s),"string"==typeof c.dependencies&&void 0===n[c.dependencies]&&a("dependencies",l,null,c,s),o(c.dependencies))for(var F=0,v=c.dependencies.length;v>F;F++)void 0===n[c.dependencies[F]]&&a("dependencies",l,null,c,s);"object"==typeof c.dependencies&&r(n,c.dependencies,f,s),i(t,c.type,function(e,i){if(e)return a("type",l,typeof t,c,s);switch(m("conform",t,function(n,e){return e(n)}),i||(o(t)?"array":typeof t)){case"string":m("minLength",t.length,function(n,e){return n>=e}),m("maxLength",t.length,function(n,e){return e>=n}),m("pattern",t,function(n,e){return e="string"==typeof e?e=RegExp(e):e,e.test(n)});break;case"integer":case"number":m("minimum",t,function(n,e){return n>=e}),m("maximum",t,function(n,e){return e>=n}),m("exclusiveMinimum",t,function(n,e){return n>e}),m("exclusiveMaximum",t,function(n,e){return e>n}),m("divisibleBy",t,function(n,e){var t=Math.max((""+(n-Math.floor(n))).length-2,(""+(e-Math.floor(e))).length-2);return t=t>0?Math.pow(10,t):1,0===n*t%(e*t)});break;case"array":m("items",t,function(e,t){for(var r=0,i=e.length;i>r;r++)u(n,e[r],l,t,f,s);return!0}),m("minItems",t,function(n,e){return n.length>=e}),m("maxItems",t,function(n,e){return e>=n.length}),m("uniqueItems",t,function(n){for(var e={},t=0,r=n.length;r>t;t++){var u=JSON.stringify(n[t]);if(e[u])return!1;e[u]=!0}return!0});break;case"object":(c.properties||c.patternProperties||c.additionalProperties)&&r(t,c,f,s)}})}function i(n,e,t){var r=o(e)?e:[e];if(void 0===e)return t(null,e);for(var u=0,i=r.length;i>u;u++)if(e=r[u].toLowerCase().trim(),"string"===e?"string"==typeof n:"array"===e?o(n):"object"===e?n&&"object"==typeof n&&!o(n):"number"===e?"number"==typeof n:"integer"===e?"number"==typeof n&&~~n===n:"null"===e?null===n:"boolean"===e?"boolean"==typeof n:"any"===e?n!==void 0:!1)return t(null,e);t(!0)}function a(n,t,r,u,i){var a={expected:u[n],attribute:n,property:t},o=u.messages&&u.messages[n]||u.message||e.messages[n]||"no default message";o=o.replace(/%\{([a-z]+)\}/gi,function(n,e){return a[e.toLowerCase()]||""}),i.push({attribute:n,property:t,expected:u[n],actual:r,message:o})}function o(n){var e=typeof n;return"object"===e&&n&&"number"==typeof n.length&&!n.propertyIsEnumerable("length")&&"function"==typeof n.splice?!0:!1}n.validate=e,n.mixin=t,e.defaults={validateFormats:!0,validateFormatsStrict:!1,validateFormatExtensions:!0,addMissingDefaults:!1,deleteUnknownProperties:!1},e.messages={required:"is required",minLength:"is too short (minimum is %{expected} characters)",maxLength:"is too long (maximum is %{expected} characters)",pattern:"invalid input",minimum:"must be greater than or equal to %{expected}",maximum:"must be less than or equal to %{expected}",exclusiveMinimum:"must be greater than %{expected}",exclusiveMaximum:"must be less than %{expected}",divisibleBy:"must be divisible by %{expected}",minItems:"must contain more than %{expected} items",maxItems:"must contain less than %{expected} items",uniqueItems:"must hold a unique set of values",format:"is not a valid %{expected}",conform:"must conform to given constraint",type:"must be of %{expected} type"},e.messages["enum"]="must be present in given enumerator",e.formats={email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,"ip-address":/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/i,ipv6:/^([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}$/,"date-time":/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:.\d{1,3})?Z$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^\d{2}:\d{2}:\d{2}$/,color:/^#[a-z0-9]{6}|#[a-z0-9]{3}|(?:rgb\(\s*(?:[+-]?\d+%?)\s*,\s*(?:[+-]?\d+%?)\s*,\s*(?:[+-]?\d+%?)\s*\))aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|and yellow$/i,"host-name":/^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])/,"utc-millisec":{test:function(n){return"number"==typeof n&&n>=0}},regex:{test:function(n){try{RegExp(n)}catch(e){return!1}return!0}}},e.formatExtensions={url:/^(https?|ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i}})("undefined"==typeof window?module.exports:window.json=window.json||{}),function(){function n(n){var t=!1;return function(){if(t)throw Error("Callback was already called.");t=!0,n.apply(e,arguments)}}var e,t,r={};e=this,null!=e&&(t=e.async),r.noConflict=function(){return e.async=t,r};var u=function(n,e){if(n.forEach)return n.forEach(e);for(var t=0;n.length>t;t+=1)e(n[t],t,n)},i=function(n,e){if(n.map)return n.map(e);var t=[];return u(n,function(n,r,u){t.push(e(n,r,u))}),t},a=function(n,e,t){return n.reduce?n.reduce(e,t):(u(n,function(n,r,u){t=e(t,n,r,u)}),t)},o=function(n){if(Object.keys)return Object.keys(n);var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e};r.nextTick="undefined"!=typeof process&&process.nextTick?process.nextTick:"function"==typeof setImmediate?function(n){setImmediate(n)}:function(n){setTimeout(n,0)},r.each=function(e,t,r){if(r=r||function(){},!e.length)return r();var i=0;u(e,function(u){t(u,n(function(n){n?(r(n),r=function(){}):(i+=1,i>=e.length&&r(null))}))})},r.forEach=r.each,r.eachSeries=function(n,e,t){if(t=t||function(){},!n.length)return t();var u=0,i=function(){var a=!0;e(n[u],function(e){e?(t(e),t=function(){}):(u+=1,u>=n.length?t(null):a?r.nextTick(i):i())}),a=!1};i()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,e,t,r){var u=l(e);u.apply(null,[n,t,r])},r.forEachLimit=r.eachLimit;var l=function(n){return function(e,t,r){if(r=r||function(){},!e.length||0>=n)return r();var u=0,i=0,a=0;(function o(){if(u>=e.length)return r();for(;n>a&&e.length>i;)i+=1,a+=1,t(e[i-1],function(n){n?(r(n),r=function(){}):(u+=1,a-=1,u>=e.length?r():o())})})()}},c=function(n){return function(){var e=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(e))}},f=function(n,e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[l(n)].concat(t))}},s=function(n){return function(){var e=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(e))}},m=function(n,e,t,r){var u=[];e=i(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){t(n.value,function(t,r){u[n.index]=r,e(t)})},function(n){r(n,u)})};r.map=c(m),r.mapSeries=s(m),r.mapLimit=function(n,e,t,r){return p(e)(n,t,r)};var p=function(n){return f(n,m)};r.reduce=function(n,e,t,u){r.eachSeries(n,function(n,r){t(e,n,function(n,t){e=t,r(n)})},function(n){u(n,e)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,e,t,u){var a=i(n,function(n){return n}).reverse();r.reduce(a,e,t,u)},r.foldr=r.reduceRight;var d=function(n,e,t,r){var u=[];e=i(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){t(n.value,function(t){t&&u.push(n),e()})},function(){r(i(u.sort(function(n,e){return n.index-e.index}),function(n){return n.value}))})};r.filter=c(d),r.filterSeries=s(d),r.select=r.filter,r.selectSeries=r.filterSeries;var F=function(n,e,t,r){var u=[];e=i(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){t(n.value,function(t){t||u.push(n),e()})},function(){r(i(u.sort(function(n,e){return n.index-e.index}),function(n){return n.value}))})};r.reject=c(F),r.rejectSeries=s(F);var v=function(n,e,t,r){n(e,function(n,e){t(n,function(t){t?(r(n),r=function(){}):e()})},function(){r()})};r.detect=c(v),r.detectSeries=s(v),r.some=function(n,e,t){r.each(n,function(n,r){e(n,function(n){n&&(t(!0),t=function(){}),r()})},function(){t(!1)})},r.any=r.some,r.every=function(n,e,t){r.each(n,function(n,r){e(n,function(n){n||(t(!1),t=function(){}),r()})},function(){t(!0)})},r.all=r.every,r.sortBy=function(n,e,t){r.map(n,function(n,t){e(n,function(e,r){e?t(e):t(null,{value:n,criteria:r})})},function(n,e){if(n)return t(n);var r=function(n,e){var t=n.criteria,r=e.criteria;return r>t?-1:t>r?1:0};t(null,i(e.sort(r),function(n){return n.value}))})},r.auto=function(n,e){e=e||function(){};var t=o(n);if(!t.length)return e(null);var i={},l=[],c=function(n){l.unshift(n)},f=function(n){for(var e=0;l.length>e;e+=1)if(l[e]===n)return l.splice(e,1),void 0},s=function(){u(l.slice(0),function(n){n()})};c(function(){o(i).length===t.length&&(e(null,i),e=function(){})}),u(t,function(t){var l=n[t]instanceof Function?[n[t]]:n[t],m=function(n){var a=Array.prototype.slice.call(arguments,1);if(1>=a.length&&(a=a[0]),n){var l={};u(o(i),function(n){l[n]=i[n]}),l[t]=a,e(n,l),e=function(){}}else i[t]=a,r.nextTick(s)},p=l.slice(0,Math.abs(l.length-1))||[],d=function(){return a(p,function(n,e){return n&&i.hasOwnProperty(e)},!0)&&!i.hasOwnProperty(t)};if(d())l[l.length-1](m,i);else{var F=function(){d()&&(f(F),l[l.length-1](m,i))};c(F)}})},r.waterfall=function(n,e){if(e=e||function(){},!n.length)return e();var t=function(n){return function(u){if(u)e.apply(null,arguments),e=function(){};else{var i=Array.prototype.slice.call(arguments,1),a=n.next();a?i.push(t(a)):i.push(e),r.nextTick(function(){n.apply(null,i)})}}};t(r.iterator(n))()};var y=function(n,e,t){if(t=t||function(){},e.constructor===Array)n.map(e,function(n,e){n&&n(function(n){var t=Array.prototype.slice.call(arguments,1);1>=t.length&&(t=t[0]),e.call(null,n,t)})},t);else{var r={};n.each(o(e),function(n,t){e[n](function(e){var u=Array.prototype.slice.call(arguments,1);1>=u.length&&(u=u[0]),r[n]=u,t(e)})},function(n){t(n,r)})}};r.parallel=function(n,e){y({map:r.map,each:r.each},n,e)},r.parallelLimit=function(n,e,t){y({map:p(e),each:l(e)},n,t)},r.series=function(n,e){if(e=e||function(){},n.constructor===Array)r.mapSeries(n,function(n,e){n&&n(function(n){var t=Array.prototype.slice.call(arguments,1);1>=t.length&&(t=t[0]),e.call(null,n,t)})},e);else{var t={};r.eachSeries(o(n),function(e,r){n[e](function(n){var u=Array.prototype.slice.call(arguments,1);1>=u.length&&(u=u[0]),t[e]=u,r(n)})},function(n){e(n,t)})}},r.iterator=function(n){var e=function(t){var r=function(){return n.length&&n[t].apply(null,arguments),r.next()};return r.next=function(){return n.length-1>t?e(t+1):null},r};return e(0)},r.apply=function(n){var e=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var h=function(n,e,t,r){var u=[];n(e,function(n,e){t(n,function(n,t){u=u.concat(t||[]),e(n)})},function(n){r(n,u)})};r.concat=c(h),r.concatSeries=s(h),r.whilst=function(n,e,t){if(n()){var u=!0;e(function(i){return i?t(i):(u?r.nextTick(function(){r.whilst(n,e,t)}):r.whilst(n,e,t),void 0)}),u=!1}else t()},r.doWhilst=function(n,e,t){var u=!0;n(function(i){return i?t(i):(e()?u?r.nextTick(function(){r.doWhilst(n,e,t)}):r.doWhilst(n,e,t):t(),void 0)}),u=!1},r.until=function(n,e,t){if(n())t();else{var u=!0;e(function(i){return i?t(i):(u?r.nextTick(function(){r.until(n,e,t)}):r.until(n,e,t),void 0)}),u=!1}},r.doUntil=function(n,e,t){var u=!0;n(function(i){return i?t(i):(e()?t():u?r.nextTick(function(){r.doUntil(n,e,t)}):r.doUntil(n,e,t),void 0)}),u=!1},r.queue=function(e,t){function i(n,e,i,a){e.constructor!==Array&&(e=[e]),u(e,function(e){var u={data:e,callback:"function"==typeof a?a:null};i?n.tasks.unshift(u):n.tasks.push(u),n.saturated&&n.tasks.length===t&&n.saturated(),r.nextTick(n.process)})}void 0===t&&(t=1);var a=0,o={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,push:function(n,e){i(o,n,!1,e)},unshift:function(n,e){i(o,n,!0,e)},process:function(){if(o.concurrency>a&&o.tasks.length){var t=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),a+=1;var u=!0,i=function(){a-=1,t.callback&&t.callback.apply(t,arguments),o.drain&&0===o.tasks.length+a&&o.drain(),o.process()},l=n(function(){var n=arguments;u?r.nextTick(function(){i.apply(null,n)}):i.apply(null,arguments)});e(t.data,l),u=!1}},length:function(){return o.tasks.length},running:function(){return a}};return o},r.cargo=function(n,e){var t=!1,a=[],o={tasks:a,payload:e,saturated:null,empty:null,drain:null,push:function(n,t){n.constructor!==Array&&(n=[n]),u(n,function(n){a.push({data:n,callback:"function"==typeof t?t:null}),o.saturated&&a.length===e&&o.saturated()}),r.nextTick(o.process)},process:function l(){if(!t){if(0===a.length)return o.drain&&o.drain(),void 0;var r="number"==typeof e?a.splice(0,e):a.splice(0),c=i(r,function(n){return n.data});o.empty&&o.empty(),t=!0,n(c,function(){t=!1;var n=arguments;u(r,function(e){e.callback&&e.callback.apply(null,n)}),l()})}},length:function(){return a.length},running:function(){return t}};return o};var g=function(n){return function(e){var t=Array.prototype.slice.call(arguments,1);e.apply(null,t.concat([function(e){var t=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[n]&&u(t,function(e){console[n](e)}))}]))}};r.log=g("log"),r.dir=g("dir"),r.memoize=function(n,e){var t={},r={};e=e||function(n){return n};var u=function(){var u=Array.prototype.slice.call(arguments),i=u.pop(),a=e.apply(null,u);a in t?i.apply(null,t[a]):a in r?r[a].push(i):(r[a]=[i],n.apply(null,u.concat([function(){t[a]=arguments;var n=r[a];delete r[a];for(var e=0,u=n.length;u>e;e++)n[e].apply(null,arguments)}])))};return u.memo=t,u.unmemoized=n,u},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,e,t){for(var u=[],i=0;n>i;i++)u.push(i);return r.map(u,e,t)},r.timesSeries=function(n,e,t){for(var u=[],i=0;n>i;i++)u.push(i);return r.mapSeries(u,e,t)},r.compose=function(){var n=Array.prototype.reverse.call(arguments);return function(){var e=this,t=Array.prototype.slice.call(arguments),u=t.pop();r.reduce(n,t,function(n,t,r){t.apply(e,n.concat([function(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);r(n,e)}]))},function(n,t){u.apply(e,[n].concat(t))})}},r.applyEach=function(n){var e=function(){var e=this,t=Array.prototype.slice.call(arguments),u=t.pop();return r.each(n,function(n,r){n.apply(e,t.concat([r]))},u)};if(arguments.length>1){var t=Array.prototype.slice.call(arguments,1);return e.apply(this,t)}return e},"undefined"!=typeof define&&define.amd?define([],function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:e.async=r}(),function(n,e,t){"use strict";function r(n,t){if("string"!=typeof n||!(t instanceof RegExp))throw Error("extensionName or extensionValue undefined or not correct type");if(e.validate.formats.hasOwnProperty(n)||e.validate.formats.hasOwnProperty(n)){var r="extensionName: "+n+" already exists in formatExtensions.";throw Error(r)}e.validate.formatExtensions[n]=t}function u(n,t){return e.validate.messages[n].replace("%{expected}",t)+""}function i(n,e,t){var r={attribute:"",expected:"",actual:"",message:""};return r.attribute=n,r.expected=e,r.actual=t,r.message=u(n,e),r}function a(n){var e={valid:!0,errors:[]};return null!==n&&(e.valid=!1,e.errors.push(n)),e}function o(n){for(var e={},t=0,r=n.length;r>t;t++){var u=JSON.stringify(n[t]);if(e[u])return!1;e[u]=!0}return!0}function l(){var n={};return n.email=function(n){return e.validate.formats.email.test(n)?a(null):a(i("format","email",n))},n.ipAddress=function(n){return e.validate.formats["ip-address"].test(n)?a(null):a(i("format","ip-address",n))},n.ipv6=function(n){return e.validate.formats.ipv6.test(n)?a(null):a(i("format","ipv6",n))},n.dateTime=function(n){return e.validate.formats["date-time"].test(n)?a(null):a(i("format","date-time",n))},n.date=function(n){return e.validate.formats.date.test(n)?a(null):a(i("format","date",n))},n.time=function(n){return e.validate.formats.time.test(n)?a(null):a(i("format","time",n))},n.color=function(n){return e.validate.formats.color.test(n)?a(null):a(i("format","color",n))},n.hostName=function(n){return e.validate.formats["host-name"].test(n)?a(null):a(i("format","host-name",n))},n.utcMillisec=function(n){return e.validate.formats["utc-millisec"].test(n)?a(null):a(i("format","utc-millisec",n))},n.regex=function(n){return n instanceof RegExp?a(null):a(i("format","regex",n))},n.url=function(n){return e.validate.formatExtensions.url.test(n)?a(null):a(i("format","url",n))},n.mongoId=function(n){return e.validate.formatExtensions["mongo-id"].test(n)?a(null):a(i("format","url",n))},n.numberFloat=function(n){return e.validate.formatExtensions["number-float"].test(n)?a(null):a(i("format","url",n))},n}function c(){var n={};return n.string=function(n){return"string"!=typeof n?a(i("type","string",n)):a(null)},n.number=function(n){return"number"!=typeof n?a(i("type","number",n)):a(null)},n.boolean=function(n){return"boolean"!=typeof n?a(i("type","boolean",n)):a(null)},n.object=function(n){return"object"!=typeof n?a(i("type","object",n)):a(null)},n.undefined=function(n){return n!==void 0?a(i("type","undefined",n)):a(null)},n.integer=function(n){return"number"!=typeof n||~~n!==n?a(i("type","integer",n)):a(null)},n.float=function(n){return RegExp(/^[\-\+]?\b(\d+[.]\d+$)$/).exec(n)?a(null):a(i("type","float",n))},n.array=function(n){return Array.isArray(n)?a(null):a(i("type","array",n))},n.date=function(n){return n instanceof Date?a(null):a(i("type","Date",n))},n.regexp=function(n){return n instanceof RegExp?a(null):a(i("type","RegExp",n))},n.null=function(n){return null!==n?a(i("type","null",n)):a(null)},n}function f(){var n={};return n.maxLength=function(n,e){return!Array.isArray(n)&&"string"!=typeof n||"number"!=typeof e?a(Error("rules.maxLength(fail): value must be a string or array, max must be a number")):n.length>e?a(i("maxLength",e,n)):a(null)},n.minLength=function(n,e){return!Array.isArray(n)&&"string"!=typeof n||"number"!=typeof e?a(Error("rules.minLength(fail): value must be a string or array, min must be a number")):e>n.length?a(i("minLength",e,n)):a(null)},n.minimum=function(n,e){return"number"!=typeof n||"number"!=typeof e?a(Error("rules.minimum(fail): value must be a number, min must be a number")):e>n?a(i("minimum",e,n)):a(null)},n.maximum=function(n,e){return"number"!=typeof n||"number"!=typeof e?a(Error("rules.maximum(fail): value must be a number, max must be a number")):n>e?a(i("maximum",e,n)):a(null)},n.exclusiveMinimum=function(n,e){return"number"!=typeof n||"number"!=typeof e?a(Error("rules.exclusiveMinimum(fail): value must be a number, min must be a number")):e>=n?a(i("exclusiveMinimum",e,n)):a(null)},n.exclusiveMaximum=function(n,e){return"number"!=typeof n||"number"!=typeof e?a(Error("rules.exclusiveMaximum(fail): value must be a number, max must be a number")):n>=e?a(i("exclusiveMinimum",e,n)):a(null)},n.divisibleBy=function(n,e){if("number"!=typeof n||"number"!=typeof e)return a(Error("rules.divisibleBy(fail): value must be a number, div must be a number"));var t=Math.max((""+(n-Math.floor(n))).length-2,(""+(e-Math.floor(e))).length-2);return t=t>0?Math.pow(10,t):1,0!==n*t%(e*t)?a(i("divisibleBy",e,n)):a(null)},n.minItems=function(n,e){return Array.isArray(n)&&"number"==typeof e?e>n.length?a(i("minItems",e,n.length)):a(null):a(Error("rules.minItems(fail): value must be a array, min must be a number"))},n.maxItems=function(n,e){return Array.isArray(n)&&"number"==typeof e?n.length>e?a(i("maxItems",e,n.length)):a(null):a(Error("rules.maxItems(fail): value must be a array, max must be a number"))},n.uniqueItems=function(n){return Array.isArray(n)?o(n)?a(null):a(i("uniqueItems",n,!0)):a(Error("rules.uniqueItems(fail): value must be a array"))},n.enum=function(n,e){return void 0!==n&&Array.isArray(e)?-1===e.indexOf(n)?a(i("enum",e,n)):a(null):a(Error("rules.enum(fail): value must be a defined and enum mus be a array"))},n}function s(){var n={},e=[];return n.register=function(n,t){e.push(function(e){n(t,e)})},n.exec=function(n,r){t.parallel(e,function(t,u){if(e=[],t)r(t);else{var i,a;for(i=0,a=u.length;a>i;i+=1)u[i].valid||(n.valid=!1,n.errors.push(u[i].errors[0]));r(null,n)}})},n}e.validate.formatExtensions["mongo-id"]=/^[0-9a-fA-F]{8}[0-9a-fA-F]{6}[0-9a-fA-F]{4}[0-9a-fA-F]{6}$/,e.validate.formatExtensions["number-float"]=/^[\-\+]?\b(\d+[.]\d+$)$/,n.validate=e.validate,n.mixin=e.mixin,n.extendFormat=r,n.formats=l(),n.types=c(),n.rules=f(),n.asyncValidate=s()}("undefined"==typeof window?module.exports:window.lxvalid=window.lxvalid||{},"undefined"==typeof window?require("revalidator"):window.json,"undefined"==typeof window?require("async"):window.async);